# üå± GREEN FUND - DATABASE SCHEMA DESIGN (SUPABASE)

## üìã M·ª§C L·ª§C
1. [T·ªïng quan h·ªá th·ªëng](#t·ªïng-quan-h·ªá-th·ªëng)
2. [S∆° ƒë·ªì quan h·ªá (ERD)](#s∆°-ƒë·ªì-quan-h·ªá-erd)
3. [Chi ti·∫øt c√°c b·∫£ng](#chi-ti·∫øt-c√°c-b·∫£ng)
4. [Policies & Row Level Security](#policies--row-level-security)
5. [H∆∞·ªõng d·∫´n t·∫°o database tr√™n Supabase](#h∆∞·ªõng-d·∫´n-t·∫°o-database-tr√™n-supabase)
6. [H∆∞·ªõng d·∫´n t√≠ch h·ª£p v√†o d·ª± √°n](#h∆∞·ªõng-d·∫´n-t√≠ch-h·ª£p-v√†o-d·ª±-√°n)

---

## üéØ T·ªîNG QUAN H·ªÜ TH·ªêNG

**Green Fund** l√† n·ªÅn t·∫£ng P2P lending t·∫≠p trung v√†o c√°c d·ª± √°n xanh, b·ªÅn v·ªØng. H·ªá th·ªëng c√≥ 2 vai tr√≤ ch√≠nh:
- **Borrower (Ng∆∞·ªùi vay)**: T·∫°o d·ª± √°n, qu·∫£n l√Ω kho·∫£n vay, tr·∫£ n·ª£
- **Lender (Nh√† ƒë·∫ßu t∆∞)**: ƒê·∫ßu t∆∞ v√†o d·ª± √°n, nh·∫≠n l√£i su·∫•t

---

## üîó S∆† ƒê·ªí QUAN H·ªÜ (ERD)

```
users (1) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ< (n) loans
users (1) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ< (n) investments
users (1) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ< (n) transactions
users (1) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ< (n) wallets
loans (1) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ< (n) investments
loans (1) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ< (n) loan_payments
loans (1) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ< (n) loan_documents
loans (1) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ< (n) loan_timeline
investments (1) ‚îÄ‚îÄ< (n) investment_returns
```

---

## üìä CHI TI·∫æT C√ÅC B·∫¢NG

### 1. üë§ **B·∫¢NG: users**
Qu·∫£n l√Ω th√¥ng tin ng∆∞·ªùi d√πng (c·∫£ Borrower v√† Lender)

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID ng∆∞·ªùi d√πng (t·ª± sinh) |
| `email` | VARCHAR(255) | UNIQUE, NOT NULL | Email ƒëƒÉng nh·∫≠p |
| `password_hash` | VARCHAR(255) | NOT NULL | M·∫≠t kh·∫©u ƒë√£ m√£ h√≥a (bcrypt) |
| `full_name` | VARCHAR(255) | NOT NULL | H·ªç v√† t√™n ƒë·∫ßy ƒë·ªß |
| `phone` | VARCHAR(20) | | S·ªë ƒëi·ªán tho·∫°i |
| `id_number` | VARCHAR(20) | UNIQUE | S·ªë CMND/CCCD |
| `date_of_birth` | DATE | | Ng√†y sinh |
| `address` | TEXT | | ƒê·ªãa ch·ªâ chi ti·∫øt |
| `avatar_url` | TEXT | | URL ·∫£nh ƒë·∫°i di·ªán |
| `role` | VARCHAR(20) | NOT NULL, DEFAULT 'borrower' | 'borrower' ho·∫∑c 'lender' |
| `bank_account` | VARCHAR(50) | | S·ªë t√†i kho·∫£n ng√¢n h√†ng |
| `bank_name` | VARCHAR(100) | | T√™n ng√¢n h√†ng |
| `is_verified` | BOOLEAN | DEFAULT FALSE | Tr·∫°ng th√°i x√°c minh t√†i kho·∫£n |
| `kyc_status` | VARCHAR(20) | DEFAULT 'pending' | 'pending', 'approved', 'rejected' |
| `kyc_submitted_at` | TIMESTAMP | | Th·ªùi gian n·ªôp KYC |
| `kyc_verified_at` | TIMESTAMP | | Th·ªùi gian x√°c minh KYC |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o t√†i kho·∫£n |
| `updated_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y c·∫≠p nh·∫≠t cu·ªëi |
| `last_login_at` | TIMESTAMP | | L·∫ßn ƒëƒÉng nh·∫≠p cu·ªëi |

**Indexes:**
- `idx_users_email` ON `email`
- `idx_users_id_number` ON `id_number`
- `idx_users_role` ON `role`

---

### 2. üí∞ **B·∫¢NG: wallets**
V√≠ ƒëi·ªán t·ª≠ c·ªßa ng∆∞·ªùi d√πng

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID v√≠ |
| `user_id` | UUID | FOREIGN KEY ‚Üí users(id), NOT NULL | ID ng∆∞·ªùi d√πng |
| `balance` | DECIMAL(15,2) | DEFAULT 0.00, CHECK (balance >= 0) | S·ªë d∆∞ hi·ªán t·∫°i (VND) |
| `total_deposited` | DECIMAL(15,2) | DEFAULT 0.00 | T·ªïng ti·ªÅn ƒë√£ n·∫°p |
| `total_withdrawn` | DECIMAL(15,2) | DEFAULT 0.00 | T·ªïng ti·ªÅn ƒë√£ r√∫t |
| `total_invested` | DECIMAL(15,2) | DEFAULT 0.00 | T·ªïng ti·ªÅn ƒë√£ ƒë·∫ßu t∆∞ |
| `total_borrowed` | DECIMAL(15,2) | DEFAULT 0.00 | T·ªïng ti·ªÅn ƒë√£ vay |
| `available_balance` | DECIMAL(15,2) | DEFAULT 0.00 | S·ªë d∆∞ kh·∫£ d·ª•ng (kh√¥ng b·ªã kh√≥a) |
| `locked_balance` | DECIMAL(15,2) | DEFAULT 0.00 | S·ªë d∆∞ b·ªã kh√≥a (ƒëang ƒë·∫ßu t∆∞) |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o v√≠ |
| `updated_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y c·∫≠p nh·∫≠t cu·ªëi |

**Constraints:**
- UNIQUE (`user_id`) - M·ªói user ch·ªâ c√≥ 1 v√≠
- CHECK: `balance = available_balance + locked_balance`

**Indexes:**
- `idx_wallets_user_id` ON `user_id`

---

### 3. üì¶ **B·∫¢NG: loan_packages**
C√°c g√≥i vay theo lƒ©nh v·ª±c ESG

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | VARCHAR(50) | PRIMARY KEY | ID g√≥i (green-agriculture, renewable-energy, ...) |
| `name` | VARCHAR(255) | NOT NULL | T√™n g√≥i (ti·∫øng Vi·ªát) |
| `name_en` | VARCHAR(255) | | T√™n g√≥i (ti·∫øng Anh) |
| `description` | TEXT | | M√¥ t·∫£ ng·∫Øn |
| `image_url` | TEXT | | URL h√¨nh ·∫£nh ƒë·∫°i di·ªán |
| `interest_rate_min` | DECIMAL(5,2) | | L√£i su·∫•t t·ªëi thi·ªÉu (%) |
| `interest_rate_max` | DECIMAL(5,2) | | L√£i su·∫•t t·ªëi ƒëa (%) |
| `max_term_months` | INTEGER | | K·ª≥ h·∫°n t·ªëi ƒëa (th√°ng) |
| `is_active` | BOOLEAN | DEFAULT TRUE | C√≤n ho·∫°t ƒë·ªông kh√¥ng |
| `display_order` | INTEGER | DEFAULT 0 | Th·ª© t·ª± hi·ªÉn th·ªã |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o |
| `updated_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y c·∫≠p nh·∫≠t |

**D·ªØ li·ªáu m·∫´u:**
```sql
INSERT INTO loan_packages (id, name, name_en, description) VALUES
('green-agriculture', 'N√îNG NGHI·ªÜP XANH', 'Green Agriculture', 'Ph√°t tri·ªÉn n√¥ng nghi·ªáp c√¥ng ngh·ªá cao, gi·∫£m ph√°t th·∫£i'),
('renewable-energy', 'NƒÇNG L∆Ø·ª¢NG T√ÅI T·∫†O', 'Renewable Energy', 'NƒÉng l∆∞·ª£ng s·∫°ch, b·ªÅn v·ªØng cho t∆∞∆°ng lai'),
('sustainable-consumption', 'S·∫¢N XU·∫§T TI√äU D√ôNG B·ªÄN V·ªÆNG', 'Sustainable Consumption', 'S·∫£n ph·∫©m th√¢n thi·ªán m√¥i tr∆∞·ªùng'),
('environmental-tech', 'C√îNG NGH·ªÜ M√îI TR∆Ø·ªúNG', 'Environmental Technology', 'C√¥ng ngh·ªá x·ª≠ l√Ω m√¥i tr∆∞·ªùng ti√™n ti·∫øn');
```

---

### 4. üí≥ **B·∫¢NG: loans**
Th√¥ng tin c√°c kho·∫£n vay / d·ª± √°n

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID kho·∫£n vay |
| `borrower_id` | UUID | FOREIGN KEY ‚Üí users(id), NOT NULL | ID ng∆∞·ªùi vay |
| `package_id` | VARCHAR(50) | FOREIGN KEY ‚Üí loan_packages(id), NOT NULL | ID g√≥i vay |
| `project_name` | VARCHAR(500) | NOT NULL | T√™n d·ª± √°n |
| `purpose` | TEXT | NOT NULL | M·ª•c ƒë√≠ch vay v·ªën |
| `description` | TEXT | | M√¥ t·∫£ chi ti·∫øt d·ª± √°n |
| `amount` | DECIMAL(15,2) | NOT NULL, CHECK (amount > 0) | S·ªë ti·ªÅn c·∫ßn vay (VND) |
| `funded_amount` | DECIMAL(15,2) | DEFAULT 0.00 | S·ªë ti·ªÅn ƒë√£ huy ƒë·ªông ƒë∆∞·ª£c |
| `funded_percentage` | DECIMAL(5,2) | DEFAULT 0.00, CHECK (funded_percentage BETWEEN 0 AND 100) | % ƒë√£ huy ƒë·ªông |
| `interest_rate` | DECIMAL(5,2) | NOT NULL | L√£i su·∫•t (%/nƒÉm) |
| `term_months` | INTEGER | NOT NULL, CHECK (term_months > 0) | K·ª≥ h·∫°n (th√°ng) |
| `payment_method` | VARCHAR(100) | | Ph∆∞∆°ng th·ª©c tr·∫£ n·ª£ |
| `credit_rating` | VARCHAR(10) | | X·∫øp h·∫°ng t√≠n d·ª•ng (A+, A, A-, B+, ...) |
| `status` | VARCHAR(20) | DEFAULT 'pending' | 'pending', 'approved', 'funding', 'active', 'completed', 'rejected', 'defaulted' |
| `image_url` | TEXT | | URL h√¨nh ·∫£nh d·ª± √°n |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o |
| `updated_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y c·∫≠p nh·∫≠t |
| `approved_at` | TIMESTAMP | | Ng√†y duy·ªát |
| `funded_at` | TIMESTAMP | | Ng√†y ƒë·ªß v·ªën |
| `start_date` | DATE | | Ng√†y b·∫Øt ƒë·∫ßu gi·∫£i ng√¢n |
| `end_date` | DATE | | Ng√†y k·∫øt th√∫c d·ª± ki·∫øn |
| `completed_at` | TIMESTAMP | | Ng√†y ho√†n th√†nh th·ª±c t·∫ø |

**Indexes:**
- `idx_loans_borrower_id` ON `borrower_id`
- `idx_loans_package_id` ON `package_id`
- `idx_loans_status` ON `status`
- `idx_loans_created_at` ON `created_at DESC`

---

### 5. üè¢ **B·∫¢NG: loan_companies**
Th√¥ng tin doanh nghi·ªáp c·ªßa kho·∫£n vay

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID |
| `loan_id` | UUID | FOREIGN KEY ‚Üí loans(id), UNIQUE, NOT NULL | ID kho·∫£n vay |
| `name` | VARCHAR(255) | NOT NULL | T√™n doanh nghi·ªáp |
| `type` | VARCHAR(100) | | Lo·∫°i h√¨nh (TNHH, CP, HTX, ...) |
| `registration_location` | VARCHAR(255) | | N∆°i ƒëƒÉng k√Ω kinh doanh |
| `established_year` | INTEGER | | NƒÉm th√†nh l·∫≠p |
| `employees` | INTEGER | | S·ªë nh√¢n vi√™n |
| `revenue` | DECIMAL(15,2) | | Doanh thu nƒÉm g·∫ßn nh·∫•t (VND) |
| `tax_code` | VARCHAR(50) | | M√£ s·ªë thu·∫ø |
| `business_license` | VARCHAR(100) | | S·ªë gi·∫•y ph√©p ƒêKKD |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o |
| `updated_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y c·∫≠p nh·∫≠t |

**Indexes:**
- `idx_loan_companies_loan_id` ON `loan_id`

---

### 6. üë®‚Äçüíº **B·∫¢NG: loan_representatives**
Ng∆∞·ªùi ƒë·∫°i di·ªán c·ªßa kho·∫£n vay

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID |
| `loan_id` | UUID | FOREIGN KEY ‚Üí loans(id), UNIQUE, NOT NULL | ID kho·∫£n vay |
| `name` | VARCHAR(255) | NOT NULL | H·ªç t√™n ng∆∞·ªùi ƒë·∫°i di·ªán |
| `position` | VARCHAR(100) | | Ch·ª©c v·ª• |
| `age` | INTEGER | | Tu·ªïi |
| `phone` | VARCHAR(20) | | S·ªë ƒëi·ªán tho·∫°i |
| `email` | VARCHAR(255) | | Email |
| `id_number` | VARCHAR(20) | | S·ªë CMND/CCCD |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o |
| `updated_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y c·∫≠p nh·∫≠t |

**Indexes:**
- `idx_loan_representatives_loan_id` ON `loan_id`

---

### 7. üåø **B·∫¢NG: loan_esg_scores**
ƒêi·ªÉm ESG c·ªßa kho·∫£n vay

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID |
| `loan_id` | UUID | FOREIGN KEY ‚Üí loans(id), UNIQUE, NOT NULL | ID kho·∫£n vay |
| `environmental` | INTEGER | CHECK (environmental BETWEEN 0 AND 100) | ƒêi·ªÉm M√¥i tr∆∞·ªùng (0-100) |
| `social` | INTEGER | CHECK (social BETWEEN 0 AND 100) | ƒêi·ªÉm X√£ h·ªôi (0-100) |
| `governance` | INTEGER | CHECK (governance BETWEEN 0 AND 100) | ƒêi·ªÉm Qu·∫£n tr·ªã (0-100) |
| `total_score` | INTEGER | GENERATED ALWAYS AS (ROUND((environmental + social + governance) / 3.0)) STORED | ƒêi·ªÉm t·ªïng (t·ª± t√≠nh) |
| `evaluated_by` | UUID | FOREIGN KEY ‚Üí users(id) | Ng∆∞·ªùi ƒë√°nh gi√° |
| `evaluated_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y ƒë√°nh gi√° |
| `notes` | TEXT | | Ghi ch√∫ ƒë√°nh gi√° |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o |
| `updated_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y c·∫≠p nh·∫≠t |

**Indexes:**
- `idx_loan_esg_scores_loan_id` ON `loan_id`
- `idx_loan_esg_scores_total_score` ON `total_score DESC`

---

### 8. üìÑ **B·∫¢NG: loan_documents**
T√†i li·ªáu ƒë√≠nh k√®m c·ªßa kho·∫£n vay

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID t√†i li·ªáu |
| `loan_id` | UUID | FOREIGN KEY ‚Üí loans(id), NOT NULL | ID kho·∫£n vay |
| `name` | VARCHAR(255) | NOT NULL | T√™n t√†i li·ªáu |
| `type` | VARCHAR(50) | | Lo·∫°i t√†i li·ªáu (license, financial_report, ...) |
| `file_url` | TEXT | NOT NULL | URL file tr√™n Supabase Storage |
| `file_size` | INTEGER | | K√≠ch th∆∞·ªõc file (bytes) |
| `mime_type` | VARCHAR(100) | | MIME type |
| `is_verified` | BOOLEAN | DEFAULT FALSE | ƒê√£ x√°c minh ch∆∞a |
| `verified_by` | UUID | FOREIGN KEY ‚Üí users(id) | Ng∆∞·ªùi x√°c minh |
| `verified_at` | TIMESTAMP | | Th·ªùi gian x√°c minh |
| `uploaded_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y upload |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o |

**Indexes:**
- `idx_loan_documents_loan_id` ON `loan_id`

---

### 9. üìÖ **B·∫¢NG: loan_timeline**
Timeline / l·ªô tr√¨nh th·ª±c hi·ªán d·ª± √°n

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID |
| `loan_id` | UUID | FOREIGN KEY ‚Üí loans(id), NOT NULL | ID kho·∫£n vay |
| `phase` | VARCHAR(255) | NOT NULL | T√™n giai ƒëo·∫°n |
| `duration` | VARCHAR(100) | | Th·ªùi gian (VD: "2 th√°ng") |
| `status` | VARCHAR(20) | DEFAULT 'pending' | 'completed', 'in-progress', 'pending' |
| `display_order` | INTEGER | DEFAULT 0 | Th·ª© t·ª± hi·ªÉn th·ªã |
| `start_date` | DATE | | Ng√†y b·∫Øt ƒë·∫ßu th·ª±c t·∫ø |
| `end_date` | DATE | | Ng√†y k·∫øt th√∫c th·ª±c t·∫ø |
| `notes` | TEXT | | Ghi ch√∫ |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o |
| `updated_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y c·∫≠p nh·∫≠t |

**Indexes:**
- `idx_loan_timeline_loan_id` ON `loan_id`

---

### 10. üíº **B·∫¢NG: loan_credit_history**
L·ªãch s·ª≠ t√≠n d·ª•ng c·ªßa ng∆∞·ªùi vay

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID |
| `loan_id` | UUID | FOREIGN KEY ‚Üí loans(id), UNIQUE, NOT NULL | ID kho·∫£n vay |
| `total_loans` | INTEGER | DEFAULT 0 | T·ªïng s·ªë l·∫ßn vay |
| `on_time_payment_rate` | DECIMAL(5,2) | DEFAULT 100.00 | T·ª∑ l·ªá tr·∫£ ƒë√∫ng h·∫°n (%) |
| `total_borrowed` | DECIMAL(15,2) | DEFAULT 0.00 | T·ªïng ti·ªÅn ƒë√£ vay |
| `total_repaid` | DECIMAL(15,2) | DEFAULT 0.00 | T·ªïng ti·ªÅn ƒë√£ tr·∫£ |
| `default_count` | INTEGER | DEFAULT 0 | S·ªë l·∫ßn v·ª° n·ª£ |
| `last_loan_date` | DATE | | Ng√†y vay g·∫ßn nh·∫•t |
| `notes` | TEXT | | Ghi ch√∫ |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o |
| `updated_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y c·∫≠p nh·∫≠t |

**Indexes:**
- `idx_loan_credit_history_loan_id` ON `loan_id`

---

### 11. üéØ **B·∫¢NG: loan_benefits**
L·ª£i √≠ch c·ªßa d·ª± √°n

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID |
| `loan_id` | UUID | FOREIGN KEY ‚Üí loans(id), NOT NULL | ID kho·∫£n vay |
| `benefit` | TEXT | NOT NULL | L·ª£i √≠ch |
| `display_order` | INTEGER | DEFAULT 0 | Th·ª© t·ª± hi·ªÉn th·ªã |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o |

**Indexes:**
- `idx_loan_benefits_loan_id` ON `loan_id`

---

### 12. üí∏ **B·∫¢NG: investments**
Th√¥ng tin ƒë·∫ßu t∆∞ c·ªßa nh√† ƒë·∫ßu t∆∞ v√†o d·ª± √°n

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID ƒë·∫ßu t∆∞ |
| `loan_id` | UUID | FOREIGN KEY ‚Üí loans(id), NOT NULL | ID kho·∫£n vay |
| `lender_id` | UUID | FOREIGN KEY ‚Üí users(id), NOT NULL | ID nh√† ƒë·∫ßu t∆∞ |
| `amount` | DECIMAL(15,2) | NOT NULL, CHECK (amount > 0) | S·ªë ti·ªÅn ƒë·∫ßu t∆∞ (VND) |
| `interest_rate` | DECIMAL(5,2) | NOT NULL | L√£i su·∫•t cam k·∫øt (%/nƒÉm) |
| `term_months` | INTEGER | NOT NULL | K·ª≥ h·∫°n (th√°ng) |
| `expected_return` | DECIMAL(15,2) | | L·ª£i nhu·∫≠n d·ª± ki·∫øn |
| `actual_return` | DECIMAL(15,2) | DEFAULT 0.00 | L·ª£i nhu·∫≠n th·ª±c t·∫ø |
| `status` | VARCHAR(20) | DEFAULT 'active' | 'active', 'completed', 'cancelled' |
| `invested_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y ƒë·∫ßu t∆∞ |
| `maturity_date` | DATE | | Ng√†y ƒë√°o h·∫°n |
| `completed_at` | TIMESTAMP | | Ng√†y ho√†n th√†nh |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o |
| `updated_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y c·∫≠p nh·∫≠t |

**Indexes:**
- `idx_investments_loan_id` ON `loan_id`
- `idx_investments_lender_id` ON `lender_id`
- `idx_investments_status` ON `status`

---

### 13. üí∞ **B·∫¢NG: investment_returns**
L√£i su·∫•t tr·∫£ ƒë·ªãnh k·ª≥ cho nh√† ƒë·∫ßu t∆∞

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID |
| `investment_id` | UUID | FOREIGN KEY ‚Üí investments(id), NOT NULL | ID ƒë·∫ßu t∆∞ |
| `amount` | DECIMAL(15,2) | NOT NULL | S·ªë ti·ªÅn l√£i |
| `period` | INTEGER | | K·ª≥ th·ª© (1, 2, 3, ...) |
| `due_date` | DATE | NOT NULL | Ng√†y ƒë·∫øn h·∫°n |
| `paid_date` | DATE | | Ng√†y tr·∫£ th·ª±c t·∫ø |
| `status` | VARCHAR(20) | DEFAULT 'pending' | 'pending', 'paid', 'overdue' |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o |
| `updated_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y c·∫≠p nh·∫≠t |

**Indexes:**
- `idx_investment_returns_investment_id` ON `investment_id`
- `idx_investment_returns_status` ON `status`
- `idx_investment_returns_due_date` ON `due_date`

---

### 14. üí≥ **B·∫¢NG: loan_payments**
Thanh to√°n n·ª£ c·ªßa ng∆∞·ªùi vay

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID |
| `loan_id` | UUID | FOREIGN KEY ‚Üí loans(id), NOT NULL | ID kho·∫£n vay |
| `period` | INTEGER | NOT NULL | K·ª≥ thanh to√°n th·ª© |
| `principal` | DECIMAL(15,2) | NOT NULL | Ti·ªÅn g·ªëc |
| `interest` | DECIMAL(15,2) | NOT NULL | Ti·ªÅn l√£i |
| `total_amount` | DECIMAL(15,2) | NOT NULL | T·ªïng ti·ªÅn (g·ªëc + l√£i) |
| `due_date` | DATE | NOT NULL | Ng√†y ƒë·∫øn h·∫°n |
| `paid_date` | DATE | | Ng√†y tr·∫£ th·ª±c t·∫ø |
| `status` | VARCHAR(20) | DEFAULT 'pending' | 'pending', 'paid', 'overdue', 'partial' |
| `paid_amount` | DECIMAL(15,2) | DEFAULT 0.00 | S·ªë ti·ªÅn ƒë√£ tr·∫£ |
| `late_fee` | DECIMAL(15,2) | DEFAULT 0.00 | Ph√≠ tr·∫£ ch·∫≠m |
| `notes` | TEXT | | Ghi ch√∫ |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o |
| `updated_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y c·∫≠p nh·∫≠t |

**Indexes:**
- `idx_loan_payments_loan_id` ON `loan_id`
- `idx_loan_payments_status` ON `status`
- `idx_loan_payments_due_date` ON `due_date`

---

### 15. üìä **B·∫¢NG: transactions**
L·ªãch s·ª≠ giao d·ªãch (n·∫°p, r√∫t, ƒë·∫ßu t∆∞, tr·∫£ n·ª£, ...)

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID giao d·ªãch |
| `user_id` | UUID | FOREIGN KEY ‚Üí users(id), NOT NULL | ID ng∆∞·ªùi d√πng |
| `type` | VARCHAR(50) | NOT NULL | 'deposit', 'withdraw', 'invest', 'disburse', 'repay', 'receive_interest', 'fee' |
| `amount` | DECIMAL(15,2) | NOT NULL | S·ªë ti·ªÅn |
| `balance_before` | DECIMAL(15,2) | NOT NULL | S·ªë d∆∞ tr∆∞·ªõc giao d·ªãch |
| `balance_after` | DECIMAL(15,2) | NOT NULL | S·ªë d∆∞ sau giao d·ªãch |
| `reference_id` | UUID | | ID tham chi·∫øu (loan_id, investment_id, ...) |
| `reference_type` | VARCHAR(50) | | Lo·∫°i tham chi·∫øu (loan, investment, ...) |
| `description` | TEXT | | M√¥ t·∫£ giao d·ªãch |
| `status` | VARCHAR(20) | DEFAULT 'completed' | 'pending', 'completed', 'failed', 'cancelled' |
| `metadata` | JSONB | | Th√¥ng tin b·ªï sung (JSON) |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o |

**Indexes:**
- `idx_transactions_user_id` ON `user_id`
- `idx_transactions_type` ON `type`
- `idx_transactions_created_at` ON `created_at DESC`
- `idx_transactions_reference` ON `reference_id, reference_type`

---

### 16. üì∞ **B·∫¢NG: news**
Tin t·ª©c, khuy·∫øn m√£i

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID tin t·ª©c |
| `title` | VARCHAR(500) | NOT NULL | Ti√™u ƒë·ªÅ |
| `slug` | VARCHAR(500) | UNIQUE | Slug URL |
| `content` | TEXT | | N·ªôi dung |
| `excerpt` | TEXT | | T√≥m t·∫Øt |
| `image_url` | TEXT | | URL h√¨nh ·∫£nh |
| `category` | VARCHAR(50) | | 'news', 'promotion', 'guide' |
| `author_id` | UUID | FOREIGN KEY ‚Üí users(id) | T√°c gi·∫£ |
| `is_published` | BOOLEAN | DEFAULT FALSE | ƒê√£ xu·∫•t b·∫£n ch∆∞a |
| `published_at` | TIMESTAMP | | Ng√†y xu·∫•t b·∫£n |
| `views` | INTEGER | DEFAULT 0 | S·ªë l∆∞·ª£t xem |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o |
| `updated_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y c·∫≠p nh·∫≠t |

**Indexes:**
- `idx_news_category` ON `category`
- `idx_news_published_at` ON `published_at DESC`
- `idx_news_slug` ON `slug`

---

### 17. üîî **B·∫¢NG: notifications**
Th√¥ng b√°o cho ng∆∞·ªùi d√πng

| T√™n c·ªôt | Ki·ªÉu d·ªØ li·ªáu | R√†ng bu·ªôc | M√¥ t·∫£ |
|---------|-------------|-----------|-------|
| `id` | UUID | PRIMARY KEY, DEFAULT uuid_generate_v4() | ID th√¥ng b√°o |
| `user_id` | UUID | FOREIGN KEY ‚Üí users(id), NOT NULL | ID ng∆∞·ªùi nh·∫≠n |
| `type` | VARCHAR(50) | NOT NULL | 'loan_approved', 'investment_complete', 'payment_due', ... |
| `title` | VARCHAR(255) | NOT NULL | Ti√™u ƒë·ªÅ |
| `message` | TEXT | | N·ªôi dung |
| `link` | TEXT | | Link ƒë·∫øn trang chi ti·∫øt |
| `is_read` | BOOLEAN | DEFAULT FALSE | ƒê√£ ƒë·ªçc ch∆∞a |
| `read_at` | TIMESTAMP | | Th·ªùi gian ƒë·ªçc |
| `created_at` | TIMESTAMP | DEFAULT NOW() | Ng√†y t·∫°o |

**Indexes:**
- `idx_notifications_user_id` ON `user_id`
- `idx_notifications_is_read` ON `is_read`
- `idx_notifications_created_at` ON `created_at DESC`

---

## üîê POLICIES & ROW LEVEL SECURITY

### B·∫≠t RLS cho t·∫•t c·∫£ c√°c b·∫£ng:
```sql
ALTER TABLE users ENABLE ROW LEVEL SECURITY;
ALTER TABLE wallets ENABLE ROW LEVEL SECURITY;
ALTER TABLE loans ENABLE ROW LEVEL SECURITY;
ALTER TABLE investments ENABLE ROW LEVEL SECURITY;
ALTER TABLE transactions ENABLE ROW LEVEL SECURITY;
-- ... (t∆∞∆°ng t·ª± cho c√°c b·∫£ng kh√°c)
```

### Policy Examples:

#### 1. Users - Ch·ªâ xem/s·ª≠a th√¥ng tin c·ªßa ch√≠nh m√¨nh
```sql
-- Select: Ai c≈©ng c√≥ th·ªÉ xem th√¥ng tin user kh√°c (tr·ª´ password)
CREATE POLICY "Users can view other users (public info)"
ON users FOR SELECT
USING (true);

-- Update: Ch·ªâ s·ª≠a ƒë∆∞·ª£c th√¥ng tin c·ªßa ch√≠nh m√¨nh
CREATE POLICY "Users can update own profile"
ON users FOR UPDATE
USING (auth.uid() = id);
```

#### 2. Wallets - Ch·ªâ xem v√≠ c·ªßa m√¨nh
```sql
CREATE POLICY "Users can view own wallet"
ON wallets FOR SELECT
USING (auth.uid() = user_id);

CREATE POLICY "System can update wallets"
ON wallets FOR UPDATE
USING (true); -- S·∫Ω d√πng service_role_key t·ª´ backend
```

#### 3. Loans - Borrower t·∫°o loan, m·ªçi ng∆∞·ªùi xem ƒë∆∞·ª£c
```sql
CREATE POLICY "Anyone can view approved loans"
ON loans FOR SELECT
USING (status IN ('approved', 'funding', 'active', 'completed'));

CREATE POLICY "Borrowers can create loans"
ON loans FOR INSERT
WITH CHECK (auth.uid() = borrower_id);

CREATE POLICY "Borrowers can update own loans"
ON loans FOR UPDATE
USING (auth.uid() = borrower_id AND status = 'pending');
```

#### 4. Investments - Lender ƒë·∫ßu t∆∞, ch·ªâ xem investment c·ªßa m√¨nh
```sql
CREATE POLICY "Lenders can view own investments"
ON investments FOR SELECT
USING (auth.uid() = lender_id);

CREATE POLICY "Lenders can create investments"
ON investments FOR INSERT
WITH CHECK (auth.uid() = lender_id);
```

#### 5. Transactions - Ch·ªâ xem transaction c·ªßa m√¨nh
```sql
CREATE POLICY "Users can view own transactions"
ON transactions FOR SELECT
USING (auth.uid() = user_id);
```

---

## üõ†Ô∏è H∆Ø·ªöNG D·∫™N T·∫†O DATABASE TR√äN SUPABASE

### B∆Ø·ªöC 1: T·∫°o Project Supabase
1. Truy c·∫≠p https://supabase.com
2. ƒêƒÉng nh·∫≠p / ƒêƒÉng k√Ω t√†i kho·∫£n
3. Click **"New Project"**
4. ƒêi·ªÅn th√¥ng tin:
   - **Name**: `green-fund`
   - **Database Password**: T·∫°o password m·∫°nh (L∆ØU L·∫†I!)
   - **Region**: Singapore (g·∫ßn VN nh·∫•t)
   - **Pricing Plan**: Free (ƒë·ªß ƒë·ªÉ test)
5. Click **"Create new project"** ‚Üí ƒê·ª£i 2-3 ph√∫t

---

### B∆Ø·ªöC 2: T·∫°o Database Schema

#### 2.1. M·ªü SQL Editor
1. Sidebar b√™n tr√°i ‚Üí Click **"SQL Editor"**
2. Click **"New query"**

#### 2.2. Copy & Paste Script SQL

**File: `create_tables.sql`** (T√¥i s·∫Ω t·∫°o file ri√™ng v·ªõi full SQL script)

```sql
-- Enable UUID extension
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

-- 1. Create users table
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  email VARCHAR(255) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  full_name VARCHAR(255) NOT NULL,
  phone VARCHAR(20),
  id_number VARCHAR(20) UNIQUE,
  date_of_birth DATE,
  address TEXT,
  avatar_url TEXT,
  role VARCHAR(20) NOT NULL DEFAULT 'borrower' CHECK (role IN ('borrower', 'lender', 'admin')),
  bank_account VARCHAR(50),
  bank_name VARCHAR(100),
  is_verified BOOLEAN DEFAULT FALSE,
  kyc_status VARCHAR(20) DEFAULT 'pending' CHECK (kyc_status IN ('pending', 'approved', 'rejected')),
  kyc_submitted_at TIMESTAMP,
  kyc_verified_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  last_login_at TIMESTAMP
);

-- Create indexes for users
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_id_number ON users(id_number);
CREATE INDEX idx_users_role ON users(role);

-- ... (ti·∫øp t·ª•c v·ªõi c√°c b·∫£ng kh√°c)
```

#### 2.3. Ch·∫°y Script
1. Paste to√†n b·ªô SQL script v√†o editor
2. Click **"Run"** (ho·∫∑c Ctrl/Cmd + Enter)
3. Ki·ªÉm tra **"Results"** panel ‚Üí Th√†nh c√¥ng n·∫øu th·∫•y "Success"

---

### B∆Ø·ªöC 3: Insert D·ªØ li·ªáu m·∫´u

```sql
-- Insert loan packages
INSERT INTO loan_packages (id, name, name_en, description, image_url) VALUES
('green-agriculture', 'N√îNG NGHI·ªÜP XANH', 'Green Agriculture', 'Ph√°t tri·ªÉn n√¥ng nghi·ªáp c√¥ng ngh·ªá cao, gi·∫£m ph√°t th·∫£i', '/images/green-agriculture.jpg'),
('renewable-energy', 'NƒÇNG L∆Ø·ª¢NG T√ÅI T·∫†O', 'Renewable Energy', 'NƒÉng l∆∞·ª£ng s·∫°ch, b·ªÅn v·ªØng cho t∆∞∆°ng lai', '/images/renewable-energy.jpg'),
('sustainable-consumption', 'S·∫¢N XU·∫§T TI√äU D√ôNG B·ªÄN V·ªÆNG', 'Sustainable Consumption', 'S·∫£n ph·∫©m th√¢n thi·ªán m√¥i tr∆∞·ªùng', '/images/sustainable-consumption.jpg'),
('environmental-tech', 'C√îNG NGH·ªÜ M√îI TR∆Ø·ªúNG', 'Environmental Technology', 'C√¥ng ngh·ªá x·ª≠ l√Ω m√¥i tr∆∞·ªùng ti√™n ti·∫øn', '/images/environmental-tech.jpg');

-- Insert sample admin user
INSERT INTO users (email, password_hash, full_name, role) VALUES
('admin@greenfund.vn', '$2a$10$...', 'Admin Green Fund', 'admin');
```

---

### B∆Ø·ªöC 4: Setup Row Level Security (RLS)

1. SQL Editor ‚Üí New query
2. Copy paste policies t·ª´ section **"POLICIES & ROW LEVEL SECURITY"** ·ªü tr√™n
3. Run

---

### B∆Ø·ªöC 5: Setup Storage (L∆∞u ·∫£nh)

1. Sidebar ‚Üí **"Storage"**
2. Click **"Create a new bucket"**
3. Bucket settings:
   - **Name**: `loan-images`
   - **Public**: ‚úÖ ON (ƒë·ªÉ public access)
   - **File size limit**: 5 MB
   - **Allowed MIME types**: `image/jpeg, image/png, image/jpg, image/webp`
4. Click **"Create bucket"**

L√†m t∆∞∆°ng t·ª± cho:
- `loan-documents` (private bucket cho t√†i li·ªáu)
- `user-avatars` (public bucket cho avatar)

---

### B∆Ø·ªöC 6: L·∫•y API Keys

1. Sidebar ‚Üí **"Project Settings"** (icon b√°nh rƒÉng)
2. **"API"** section
3. Copy 2 keys:
   - **`anon` / `public` key** ‚Üí D√πng trong frontend
   - **`service_role` key** ‚Üí D√πng trong backend (B·∫¢O M·∫¨T!)

---

## üì¶ H∆Ø·ªöNG D·∫™N T√çCH H·ª¢P V√ÄO D·ª∞ √ÅN

### B∆Ø·ªöC 1: C√†i ƒë·∫∑t Supabase Client

```bash
cd front_end
npm install @supabase/supabase-js
```

---

### B∆Ø·ªöC 2: T·∫°o Supabase Config

**File: `/front_end/src/lib/supabase.js`**

```javascript
import { createClient } from '@supabase/supabase-js';

const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;
const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;

export const supabase = createClient(supabaseUrl, supabaseAnonKey);
```

---

### B∆Ø·ªöC 3: T·∫°o file `.env`

**File: `/front_end/.env`**

```env
VITE_SUPABASE_URL=https://xxxxx.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

‚ö†Ô∏è **L∆ØU √ù:** Thay `xxxxx` b·∫±ng URL v√† key th·∫≠t c·ªßa b·∫°n

---

### B∆Ø·ªöC 4: Update `.gitignore`

```gitignore
# Environment variables
.env
.env.local
.env.production
```

---

### B∆Ø·ªöC 5: T·∫°o API Services

**File: `/front_end/src/services/authService.js`**

```javascript
import { supabase } from '../lib/supabase';

export const authService = {
  // ƒêƒÉng k√Ω
  async signUp(email, password, fullName) {
    const { data, error } = await supabase.auth.signUp({
      email,
      password,
      options: {
        data: {
          full_name: fullName
        }
      }
    });
    
    if (error) throw error;
    
    // Insert v√†o b·∫£ng users
    const { error: insertError } = await supabase
      .from('users')
      .insert({
        id: data.user.id,
        email,
        full_name: fullName
      });
    
    if (insertError) throw insertError;
    
    return data;
  },

  // ƒêƒÉng nh·∫≠p
  async signIn(email, password) {
    const { data, error } = await supabase.auth.signInWithPassword({
      email,
      password
    });
    
    if (error) throw error;
    return data;
  },

  // ƒêƒÉng xu·∫•t
  async signOut() {
    const { error } = await supabase.auth.signOut();
    if (error) throw error;
  },

  // L·∫•y user hi·ªán t·∫°i
  async getCurrentUser() {
    const { data: { user } } = await supabase.auth.getUser();
    return user;
  }
};
```

**File: `/front_end/src/services/loanService.js`**

```javascript
import { supabase } from '../lib/supabase';

export const loanService = {
  // L·∫•y t·∫•t c·∫£ loans
  async getAllLoans(packageId = null) {
    let query = supabase
      .from('loans')
      .select(`
        *,
        loan_companies(*),
        loan_representatives(*),
        loan_esg_scores(*),
        loan_benefits(*),
        loan_timeline(*),
        loan_documents(*),
        loan_credit_history(*)
      `)
      .in('status', ['approved', 'funding', 'active', 'completed']);
    
    if (packageId) {
      query = query.eq('package_id', packageId);
    }
    
    const { data, error } = await query;
    
    if (error) throw error;
    return data;
  },

  // L·∫•y loan theo ID
  async getLoanById(id) {
    const { data, error } = await supabase
      .from('loans')
      .select(`
        *,
        loan_companies(*),
        loan_representatives(*),
        loan_esg_scores(*),
        loan_benefits(*),
        loan_timeline(*),
        loan_documents(*),
        loan_credit_history(*)
      `)
      .eq('id', id)
      .single();
    
    if (error) throw error;
    return data;
  },

  // T·∫°o loan m·ªõi
  async createLoan(loanData) {
    const { data, error } = await supabase
      .from('loans')
      .insert(loanData)
      .select()
      .single();
    
    if (error) throw error;
    return data;
  }
};
```

**File: `/front_end/src/services/investmentService.js`**

```javascript
import { supabase } from '../lib/supabase';

export const investmentService = {
  // ƒê·∫ßu t∆∞ v√†o loan
  async invest(loanId, amount) {
    const user = await supabase.auth.getUser();
    
    const { data, error } = await supabase
      .from('investments')
      .insert({
        loan_id: loanId,
        lender_id: user.data.user.id,
        amount,
        status: 'active'
      })
      .select()
      .single();
    
    if (error) throw error;
    return data;
  },

  // L·∫•y danh s√°ch ƒë·∫ßu t∆∞ c·ªßa user
  async getMyInvestments() {
    const user = await supabase.auth.getUser();
    
    const { data, error } = await supabase
      .from('investments')
      .select(`
        *,
        loans(*)
      `)
      .eq('lender_id', user.data.user.id);
    
    if (error) throw error;
    return data;
  }
};
```

---

### B∆Ø·ªöC 6: Update Components s·ª≠ d·ª•ng API

**Example: Login.jsx**

```javascript
import { authService } from '../services/authService';

const handleLogin = async (e) => {
  e.preventDefault();
  setLoading(true);
  
  try {
    const data = await authService.signIn(email, password);
    console.log('Login success:', data);
    navigate('/dashboard');
  } catch (error) {
    setError(error.message);
  } finally {
    setLoading(false);
  }
};
```

---

## üéØ T·ªîNG K·∫æT

### ƒê√£ ho√†n th√†nh:
‚úÖ Thi·∫øt k·∫ø 17 b·∫£ng database ho√†n ch·ªânh
‚úÖ ƒê·ªãnh nghƒ©a ƒë·∫ßy ƒë·ªß c√°c c·ªôt, ki·ªÉu d·ªØ li·ªáu, r√†ng bu·ªôc
‚úÖ Thi·∫øt l·∫≠p quan h·ªá gi·ªØa c√°c b·∫£ng (Foreign Keys)
‚úÖ T·∫°o indexes cho hi·ªáu nƒÉng
‚úÖ Thi·∫øt k·∫ø Row Level Security policies
‚úÖ H∆∞·ªõng d·∫´n chi ti·∫øt t·ª´ng b∆∞·ªõc setup Supabase
‚úÖ H∆∞·ªõng d·∫´n t√≠ch h·ª£p v√†o d·ª± √°n React

### C√°c b∆∞·ªõc ti·∫øp theo:
1. ‚úÖ T·∫°o project Supabase
2. ‚úÖ Ch·∫°y SQL scripts t·∫°o b·∫£ng
3. ‚úÖ Setup Storage buckets
4. ‚úÖ C√†i ƒë·∫∑t `@supabase/supabase-js`
5. ‚úÖ T·∫°o c√°c service files
6. ‚è≥ Migrate d·ªØ li·ªáu m·∫´u t·ª´ `loansData.js` sang Supabase
7. ‚è≥ Update components s·ª≠ d·ª•ng API thay v√¨ mock data
8. ‚è≥ Test to√†n b·ªô flow: Register ‚Üí Login ‚Üí Create Loan ‚Üí Invest

---

**T√°c gi·∫£:** GitHub Copilot  
**Ng√†y t·∫°o:** 17/10/2025  
**Version:** 1.0
